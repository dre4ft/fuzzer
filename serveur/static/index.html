<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>API Fuzzer Client</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>

<div class="container-fluid vh-100 d-flex flex-column p-0">

    <!-- HEADER -->
    <div class="px-3 py-2 border-bottom bg-white">
        <h5 class="mb-0">
            <i class="bi bi-bug"></i> API Fuzzer Client
        </h5>
    </div>

    <!-- MAIN -->
    <div class="flex-grow-1 d-flex flex-column overflow-hidden">

        <!-- URL + METHOD + FUZZ -->
        <div class="p-3 border-bottom bg-white">
            <div class="row g-2 align-items-center mb-2">
                <div class="col-md-2">
                    <select id="method" class="form-select">
                        <option value="">AUTO</option>
                        <option>GET</option>
                        <option>POST</option>
                        <option>PUT</option>
                        <option>PATCH</option>
                        <option>DELETE</option>
                    </select>
                </div>

                <div class="col-md-7">
                    <input id="target-url" class="form-control"
                           placeholder="http://localhost:9999/FUZZ">
                </div>

                <div class="col-md-3">
                    <button id="send-btn" class="btn btn-danger w-100">
                        <i class="bi bi-play-fill"></i> FUZZ
                    </button>
                </div>
            </div>

            <!-- FUZZ TYPE (PLACÃ‰ LOGIQUEMENT ICI) -->
            <div class="row g-2">
                <div class="col-md-12">
                    <label class="form-label mb-1">Fuzzing strategy</label>
                    <input id="fuzzing-type" class="form-control"
                           placeholder="range,1-10 | wordlist,password.txt | regex,^[a-z0-9]{2,10}$,10 | rand,10,10">
                </div>
            </div>
        </div>

        <!-- TABS -->
        <ul class="nav nav-tabs px-3 pt-2 bg-white">
            <li class="nav-item">
                <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#request-tab">
                    Request
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#response-tab">
                    Responses
                </button>
            </li>
        </ul>

        <!-- CONTENT -->
        <div class="tab-content flex-grow-1 overflow-hidden">

            <!-- REQUEST -->
            <div class="tab-pane fade show active h-100" id="request-tab">
                <div class="h-100 d-flex flex-column p-3">

                    <div class="row flex-grow-1 g-3">

                        <!-- HEADERS -->
                        <div class="col-md-6 d-flex flex-column">
                            <label class="form-label">Headers (JSON)</label>
                            <textarea
                                id="headers"
                                class="form-control font-monospace flex-grow-1"
                                placeholder='{
  "Content-Type": "application/json",
  "Authorization": "Bearer FUZZ"
}'></textarea>
                        </div>

                        <!-- BODY -->
                        <div class="col-md-6 d-flex flex-column">
                            <label class="form-label">Body (JSON)</label>
                            <textarea
                                id="body"
                                class="form-control font-monospace flex-grow-1"
                                placeholder='{
  "username": "admin",
  "password": "FUZZ"
}'></textarea>
                        </div>

                    </div>
                </div>
            </div>

            <!-- RESPONSES -->
            <div class="tab-pane fade h-100 overflow-auto p-3" id="response-tab">

                <div class="d-flex justify-content-between align-items-center mb-2">
                    <h5 class="mb-0">Fuzz Results</h5>
                    <button class="btn btn-sm btn-outline-secondary" onclick="clearResults()">
                        <i class="bi bi-trash"></i> Clear
                    </button>
                </div>

                <div class="table-responsive">
                    <table class="table table-bordered table-sm align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>#</th>
                                <th>Payload</th>
                                <th>Status</th>
                                <th>Headers</th>
                                <th>Body</th>
                            </tr>
                        </thead>
                        <tbody id="results"></tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="/static/app.js"></script>
</body>
</html>
